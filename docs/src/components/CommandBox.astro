---
interface Props {
  command?: string;
  docsLink?: string;
  docsText?: string;
}

const { 
  command = "npx sentry@latest", 
  docsLink = "./getting-started/",
  docsText = "Read the docs"
} = Astro.props;
---

<div class="command-box-wrapper">
  <div class="command-box">
    <span class="prompt">$</span>
    <span class="command-text">{command}</span>
    <button class="copy-btn" data-command={command} aria-label="Copy to clipboard">
      <svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/>
        <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>
      </svg>
      <span class="copied-text">Copied</span>
    </button>
  </div>
  <a href={docsLink} class="docs-link">
    {docsText}
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M5 12h14"/>
      <path d="m12 5 7 7-7 7"/>
    </svg>
  </a>
</div>

<style>
  .command-box-wrapper {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    flex-wrap: wrap;
  }

  .command-box {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.95rem;
    min-width: 280px;
  }

  .prompt {
    color: rgba(255, 255, 255, 0.5);
    user-select: none;
  }

  .command-text {
    color: #fff;
    flex: 1;
  }

  .copy-btn {
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: color 0.2s ease;
    font-family: inherit;
    font-size: 0.75rem;
    width: 44px;
    height: 18px;
  }

  .copy-btn:hover {
    color: #fff;
  }

  .copy-btn .copied-text {
    display: none;
    color: #22c55e;
  }

  .copy-btn.copied .copy-icon {
    display: none;
  }

  .copy-btn.copied .copied-text {
    display: inline;
  }

  .docs-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #fff !important;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    transition: all 0.2s ease;
  }

  .docs-link:hover {
    opacity: 0.8;
    gap: 0.75rem;
  }

  .docs-link svg {
    transition: transform 0.2s ease;
  }

  .docs-link:hover svg {
    transform: translateX(2px);
  }
</style>

<script>
  document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', async () => {
      const command = btn.getAttribute('data-command');
      if (command) {
        await navigator.clipboard.writeText(command);
        btn.classList.add('copied');
        setTimeout(() => btn.classList.remove('copied'), 2000);
      }
    });
  });
</script>
